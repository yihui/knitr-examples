\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage{float}    % for fig.pos='H'
\usepackage{rotfloat} % for sidewaysfigure
%\usepackage{subfig}   % for subfigure
\usepackage{subcaption}  % an alternative package for sub figures
\newcommand{\subfloat}[2][need a sub-caption]{\subcaptionbox{#1}{#2}}

\title{Graphics Options in knitr}
\author{Yihui Xie}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}
\maketitle



These options are vectorized for multiple plots per chunk: fig.cap, fig.scap, fig.alt, fig.env, fig.pos, fig.subcap, out.width, out.height, out.extra, fig.link.
When the plot hook is called, the i-th elements of these options will be
applied to the i-th plot.

Figure captions. Look at Figure \ref{fig:fig-cap-1} and \ref{fig:fig-cap-2}.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{bg} \hlstd{=} \hlkwd{rgb}\hlstd{(}\hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{)))}
\hlkwd{plot}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{10}\hlstd{)}
\end{alltt}
\end{kframe}\begin{figure}[H]
\includegraphics[width=2in]{figure/067-graphics-options-fig-cap-1} \caption[One plot]{One plot.}\label{fig:fig-cap-1}
\end{figure}

\begin{kframe}\begin{alltt}
\hlkwd{plot}\hlstd{(}\hlkwd{rnorm}\hlstd{(}\hlnum{10}\hlstd{),} \hlkwc{pch} \hlstd{=} \hlnum{19}\hlstd{)}
\end{alltt}
\end{kframe}\begin{figure}[H]
\includegraphics[width=2in]{figure/067-graphics-options-fig-cap-2} \caption[Another plot]{Another plot.}\label{fig:fig-cap-2}
\end{figure}


\end{knitrout}

Different out.width and out.height.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{bg} \hlstd{=} \hlkwd{rgb}\hlstd{(}\hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{)))}
\hlkwd{plot}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{10}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=1in]{figure/067-graphics-options-fig-out-1} 
\begin{kframe}\begin{alltt}
\hlkwd{plot}\hlstd{(}\hlkwd{rnorm}\hlstd{(}\hlnum{10}\hlstd{),} \hlkwc{pch} \hlstd{=} \hlnum{19}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=.4\linewidth]{figure/067-graphics-options-fig-out-2} 

\end{knitrout}

Different out.extra (rotate by different degrees).

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{bg} \hlstd{=} \hlkwd{rgb}\hlstd{(}\hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{)))}
\hlkwd{plot}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{10}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=2in,angle=30]{figure/067-graphics-options-fig-extra-1} 
\begin{kframe}\begin{alltt}
\hlkwd{plot}\hlstd{(}\hlkwd{rnorm}\hlstd{(}\hlnum{10}\hlstd{),} \hlkwc{pch} \hlstd{=} \hlnum{19}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=2in,angle=120]{figure/067-graphics-options-fig-extra-2} 

\end{knitrout}

Short options will be recycled: out.width below is of length 1 but there are
two plots.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{bg} \hlstd{=} \hlkwd{rgb}\hlstd{(}\hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{)))}
\hlkwd{plot}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{10}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=1in]{figure/067-graphics-options-fig-width-1} 
\begin{kframe}\begin{alltt}
\hlkwd{plot}\hlstd{(}\hlkwd{rnorm}\hlstd{(}\hlnum{10}\hlstd{),} \hlkwc{pch} \hlstd{=} \hlnum{19}\hlstd{)}
\end{alltt}
\end{kframe}
\includegraphics[width=1in]{figure/067-graphics-options-fig-width-2} 

\end{knitrout}

Use subfigures for each plot. Look at Figure \ref{fig:fig-sub-1} and \ref
{fig:fig-sub-2}. By default, knitr uses the \textbf{subfig} package, but it
has a few shortcomings, so some people prefer the \textbf{subcaption}
package. In that case, we can simply redefine the \verb|\subfloat| command;
see the preamble of this document for an example. We are actually using the
\textbf{subcaption} package in this document.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{bg} \hlstd{=} \hlkwd{rgb}\hlstd{(}\hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{)))}
\hlkwd{plot}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{10}\hlstd{)}
\hlkwd{plot}\hlstd{(}\hlkwd{rnorm}\hlstd{(}\hlnum{10}\hlstd{),} \hlkwc{pch} \hlstd{=} \hlnum{19}\hlstd{)}
\end{alltt}
\end{kframe}\begin{figure}[H]
\subfloat[one plot\label{fig:fig-sub-1}]{\includegraphics[width=.49\linewidth]{figure/067-graphics-options-fig-sub-1} }
\subfloat[the other one\label{fig:fig-sub-2}]{\includegraphics[width=.49\linewidth]{figure/067-graphics-options-fig-sub-2} }\caption[two plots]{two plots}\label{fig:fig-sub}
\end{figure}


\end{knitrout}

The second figure uses sidewaysfigure (i.e. Figure \ref{fig:fig-margin-2}).

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{bg} \hlstd{=} \hlkwd{rgb}\hlstd{(}\hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{),} \hlkwd{runif}\hlstd{(}\hlnum{1}\hlstd{)))}
\hlkwd{plot}\hlstd{(}\hlnum{1}\hlopt{:}\hlnum{10}\hlstd{)}
\end{alltt}
\end{kframe}\begin{figure}[H]
\includegraphics[width=2in]{figure/067-graphics-options-fig-margin-1} \caption[ordinary figure]{ordinary figure}\label{fig:fig-margin-1}
\end{figure}

\begin{kframe}\begin{alltt}
\hlkwd{plot}\hlstd{(}\hlkwd{rnorm}\hlstd{(}\hlnum{10}\hlstd{),} \hlkwc{pch} \hlstd{=} \hlnum{19}\hlstd{)}
\end{alltt}
\end{kframe}\begin{sidewaysfigure}[H]
\includegraphics[width=2in]{figure/067-graphics-options-fig-margin-2} \caption[sideways figure]{sideways figure}\label{fig:fig-margin-2}
\end{sidewaysfigure}


\end{knitrout}

\end{document}
